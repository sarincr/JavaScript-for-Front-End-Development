{"version":3,"sources":["../../src/tag/dynamic-tag.js"],"names":["path","node","hub","file","tagProperties","extra","properties","key","arguments","args","foundAttrs","renderBodyProp","attrsLen","t","isNullLiteral","preserveAttrs","push","objectProperty","identifier","arrayExpression","map","name","stringLiteral","isObjectExpression","renderBodyIndex","findIndex","prop","value","length","splice","dynamicTagRenderCall","expressionStatement","callExpression","arrowFunctionExpression","nullLiteral","objectExpression","_componentDefIdentifier","replaceWith"],"mappings":"uJAAA;AACA;AACA;AACA;;AAEe,kBAAUA,IAAV,EAAgB;AAC7B,QAAM;AACJC,IAAAA,IADI;AAEJC,IAAAA,GAAG,EAAE,EAAEC,IAAF,EAFD;AAGFH,EAAAA,IAHJ;AAIA,QAAMI,aAAa,GAAIJ,IAAI,CAACC,IAAL,CAAUI,KAAV,IAAmBL,IAAI,CAACC,IAAL,CAAUI,KAAV,CAAgBC,UAApC,IAAmD,EAAzE;AACA,QAAM,EAAEC,GAAF,EAAOC,SAAS,EAAEC,IAAlB,KAA2BR,IAAjC;AACA,QAAMS,UAAU,GAAG,oBAASV,IAAT,EAAe,IAAf,CAAnB;AACA,MAAIW,cAAJ;AACA,MAAIC,QAAQ,GAAGC,gBAAEC,aAAF,CAAgBJ,UAAhB,IAA8B,CAA9B,GAAkC,CAAjD;;AAEA,MAAIT,IAAI,CAACc,aAAT,EAAwB;AACtBX,IAAAA,aAAa,CAACY,IAAd;AACEH,oBAAEI,cAAF;AACEJ,oBAAEK,UAAF,CAAa,IAAb,CADF;AAEEL,oBAAEM,eAAF,CAAkBlB,IAAI,CAACc,aAAL,CAAmBK,GAAnB,CAAuB,CAAAC,IAAI,KAAIR,gBAAES,aAAF,CAAgBD,IAAhB,CAA/B,CAAlB,CAFF,CADF;;;AAMD;;AAED,MAAIR,gBAAEU,kBAAF,CAAqBb,UAArB,CAAJ,EAAsC;AACpC,UAAMc,eAAe,GAAGd,UAAU,CAACJ,UAAX,CAAsBmB,SAAtB;AACtB,KAAAC,IAAI,KAAIA,IAAI,CAACnB,GAAL,IAAYmB,IAAI,CAACnB,GAAL,CAASoB,KAAT,KAAmB,YADjB,CAAxB;;;AAIAf,IAAAA,QAAQ,GAAGF,UAAU,CAACJ,UAAX,CAAsBsB,MAAjC;;AAEA,QAAIJ,eAAe,GAAG,CAAC,CAAvB,EAA0B;AACxBb,MAAAA,cAAc,GAAGD,UAAU,CAACJ,UAAX,CAAsBkB,eAAtB,CAAjB;AACAd,MAAAA,UAAU,CAACJ,UAAX,CAAsBuB,MAAtB,CAA6BL,eAA7B,EAA8C,CAA9C;AACAZ,MAAAA,QAAQ;AACT;AACF;;AAED,QAAMkB,oBAAoB,GAAGjB,gBAAEkB,mBAAF;AAC3BlB,kBAAEmB,cAAF;AACE;AACE7B,EAAAA,IADF;AAEG,yCAFH;AAGE,qBAHF,CADF;;AAME;AACEU,kBAAEK,UAAF,CAAa,KAAb,CADF;AAEEjB,EAAAA,IAAI,CAACoB,IAFP;AAGET,EAAAA,QAAQ,GAAGC,gBAAEoB,uBAAF,CAA0B,EAA1B,EAA8BvB,UAA9B,CAAH,GAA+CG,gBAAEqB,WAAF,EAHzD;AAIEvB,EAAAA,cAAc,GAAGA,cAAc,CAACgB,KAAlB,GAA0Bd,gBAAEqB,WAAF,EAJ1C;AAKEzB,EAAAA,IAAI,IAAIA,IAAI,CAACmB,MAAb,GAAsBf,gBAAEM,eAAF,CAAkBV,IAAlB,CAAtB,GAAgDI,gBAAEqB,WAAF,EALlD;AAME9B,EAAAA,aAAa,CAACwB,MAAd;AACIf,kBAAEsB,gBAAF,CAAmB/B,aAAnB,CADJ;AAEIS,kBAAEqB,WAAF,EARN;AASE/B,EAAAA,IAAI,CAACiC,uBATP;AAUE7B,EAAAA,GAVF;AAWE,KAAG,kCAAuBP,IAAvB,CAXL,CANF,CAD2B,CAA7B;;;;;AAuBAA,EAAAA,IAAI,CAACqC,WAAL,CAAiB,mCAAqBP,oBAArB,EAA2C7B,IAA3C,CAAjB;AACD","sourcesContent":["import { types as t } from \"@marko/compiler\";\nimport { importDefault } from \"@marko/babel-utils\";\nimport { getAttrs, buildEventHandlerArray } from \"./util\";\nimport withPreviousLocation from \"../util/with-previous-location\";\n\nexport default function (path) {\n  const {\n    node,\n    hub: { file }\n  } = path;\n  const tagProperties = (path.node.extra && path.node.extra.properties) || [];\n  const { key, arguments: args } = node;\n  const foundAttrs = getAttrs(path, true);\n  let renderBodyProp;\n  let attrsLen = t.isNullLiteral(foundAttrs) ? 0 : 1;\n\n  if (node.preserveAttrs) {\n    tagProperties.push(\n      t.objectProperty(\n        t.identifier(\"pa\"),\n        t.arrayExpression(node.preserveAttrs.map(name => t.stringLiteral(name)))\n      )\n    );\n  }\n\n  if (t.isObjectExpression(foundAttrs)) {\n    const renderBodyIndex = foundAttrs.properties.findIndex(\n      prop => prop.key && prop.key.value === \"renderBody\"\n    );\n\n    attrsLen = foundAttrs.properties.length;\n\n    if (renderBodyIndex > -1) {\n      renderBodyProp = foundAttrs.properties[renderBodyIndex];\n      foundAttrs.properties.splice(renderBodyIndex, 1);\n      attrsLen--;\n    }\n  }\n\n  const dynamicTagRenderCall = t.expressionStatement(\n    t.callExpression(\n      importDefault(\n        file,\n        `marko/src/runtime/helpers/dynamic-tag`,\n        \"marko_dynamic_tag\"\n      ),\n      [\n        t.identifier(\"out\"),\n        node.name,\n        attrsLen ? t.arrowFunctionExpression([], foundAttrs) : t.nullLiteral(),\n        renderBodyProp ? renderBodyProp.value : t.nullLiteral(),\n        args && args.length ? t.arrayExpression(args) : t.nullLiteral(),\n        tagProperties.length\n          ? t.objectExpression(tagProperties)\n          : t.nullLiteral(),\n        file._componentDefIdentifier,\n        key,\n        ...buildEventHandlerArray(path)\n      ]\n    )\n  );\n\n  path.replaceWith(withPreviousLocation(dynamicTagRenderCall, node));\n}\n"],"file":"dynamic-tag.js"}