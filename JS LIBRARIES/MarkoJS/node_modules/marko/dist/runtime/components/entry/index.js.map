{"version":3,"sources":["../../../../src/runtime/components/entry/index.js"],"names":["warp10","require","safeJSONRegExp","IGNORE_GLOBAL_TYPES","Set","DEFAULT_RUNTIME_ID","FLAG_WILL_RERENDER_IN_BROWSER","FLAG_HAS_RENDER_BODY","safeJSONReplacer","match","charCodeAt","toString","isNotEmpty","obj","keys","Object","i","length","undefined","safeStringify","data","JSON","stringify","stringifyPrepare","replace","getSerializedGlobals","$global","serializedGlobalsLookup","serializedGlobals","key","value","has","addComponentsFromContext","componentsContext","componentsToHydrate","components","len","componentDef","id","component","flags","input","typeName","customEvents","scope","bubblingDomEvents","state","serializedProps","undefinedPropNames","renderBody","stateKeys","stateKey","push","extra","b","d","e","f","p","s","u","w","parts","hasExtra","nestedContexts","forEach","nestedContext","getInitComponentsData","out","componentDefs","global","isLast","didSerializeComponents","prefix","componentIdPrefix","widgetIdPrefix","l","TYPE_INDEX","typesLookup","Map","newTypes","typeIndex","get","size","set","g","t","getInitComponentsDataFromOut","runtimeId","r","writeInitComponentsCode","script","exports","getInitComponentsCode","initComponentsData","arguments","componentGlobalKey","getRenderedComponents"],"mappings":"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","sourcesContent":["\"use strict\";\n\nvar warp10 = require(\"warp10\");\nvar safeJSONRegExp = /<\\/|\\u2028|\\u2029/g;\nvar IGNORE_GLOBAL_TYPES = new Set([\"undefined\", \"function\", \"symbol\"]);\nvar DEFAULT_RUNTIME_ID = \"M\";\n\nvar FLAG_WILL_RERENDER_IN_BROWSER = 1;\nvar FLAG_HAS_RENDER_BODY = 2;\n\nfunction safeJSONReplacer(match) {\n  if (match === \"</\") {\n    return \"\\\\u003C/\";\n  } else {\n    return \"\\\\u\" + match.charCodeAt(0).toString(16);\n  }\n}\n\nfunction isNotEmpty(obj) {\n  var keys = Object.keys(obj);\n  for (var i = keys.length; i--; ) {\n    if (obj[keys[i]] !== undefined) {\n      return true;\n    }\n  }\n\n  return false;\n}\nfunction safeStringify(data) {\n  return JSON.stringify(warp10.stringifyPrepare(data)).replace(\n    safeJSONRegExp,\n    safeJSONReplacer\n  );\n}\n\nfunction getSerializedGlobals($global) {\n  let serializedGlobalsLookup = $global.serializedGlobals;\n  if (serializedGlobalsLookup) {\n    let serializedGlobals;\n    let keys = Object.keys(serializedGlobalsLookup);\n    for (let i = keys.length; i--; ) {\n      let key = keys[i];\n      if (serializedGlobalsLookup[key]) {\n        let value = $global[key];\n        if (!IGNORE_GLOBAL_TYPES.has(typeof value)) {\n          if (serializedGlobals === undefined) {\n            serializedGlobals = {};\n          }\n          serializedGlobals[key] = value;\n        }\n      }\n    }\n\n    return serializedGlobals;\n  }\n}\n\nfunction addComponentsFromContext(componentsContext, componentsToHydrate) {\n  var components = componentsContext.___components;\n\n  var len = components.length;\n\n  for (var i = 0; i < len; i++) {\n    var componentDef = components[i];\n    var id = componentDef.id;\n    var component = componentDef.___component;\n    var flags = componentDef.___flags;\n    var input = component.input || 0;\n    var typeName = component.typeName;\n    var customEvents = component.___customEvents;\n    var scope = component.___scope;\n    var bubblingDomEvents = component.___bubblingDomEvents;\n\n    var state;\n    var serializedProps;\n    var undefinedPropNames;\n\n    if (flags & FLAG_WILL_RERENDER_IN_BROWSER) {\n      if (typeof input.renderBody === \"function\") {\n        flags |= FLAG_HAS_RENDER_BODY;\n        input.renderBody = undefined;\n      }\n    } else {\n      if (component.state) {\n        state = component.state;\n        // Update state properties with an `undefined` value to have a `null`\n        // value so that the property name will be serialized down to the browser.\n        // This ensures that we add the proper getter/setter for the state property.\n        const stateKeys = Object.keys(state);\n        for (let i = stateKeys.length; i--; ) {\n          const stateKey = stateKeys[i];\n\n          if (state[stateKey] === undefined) {\n            if (undefinedPropNames) {\n              undefinedPropNames.push(stateKey);\n            } else {\n              undefinedPropNames = [stateKey];\n            }\n          }\n        }\n      }\n\n      component.___state = undefined; // We don't use `delete` to avoid V8 deoptimization\n      component.___input = undefined; // We don't use `delete` to avoid V8 deoptimization\n      component.typeName = undefined;\n      component.id = undefined;\n      component.___customEvents = undefined;\n      component.___scope = undefined;\n      component.___bubblingDomEvents = undefined;\n      component.___bubblingDomEventsExtraArgsCount = undefined;\n      component.___updatedInput = undefined;\n      component.___updateQueued = undefined;\n\n      if (isNotEmpty(component)) {\n        serializedProps = component;\n      }\n    }\n\n    var extra = {\n      b: bubblingDomEvents,\n      d: componentDef.___domEvents,\n      e: customEvents,\n      f: flags || undefined,\n      p: customEvents && scope, // Only serialize scope if we need to attach custom events\n      s: state,\n      u: undefinedPropNames,\n      w: serializedProps\n    };\n\n    var parts = [id, typeName];\n    var hasExtra = isNotEmpty(extra);\n\n    if (input) {\n      parts.push(input);\n\n      if (hasExtra) {\n        parts.push(extra);\n      }\n    } else if (hasExtra) {\n      parts.push(0, extra); // empty input;\n    }\n\n    componentsToHydrate.push(parts);\n  }\n\n  components.length = 0;\n\n  // Also add any components from nested contexts\n  var nestedContexts = componentsContext.___nestedContexts;\n  if (nestedContexts !== undefined) {\n    nestedContexts.forEach(function (nestedContext) {\n      addComponentsFromContext(nestedContext, componentsToHydrate);\n    });\n  }\n}\n\nfunction getInitComponentsData(out, componentDefs) {\n  const len = componentDefs.length;\n  const $global = out.global;\n  const isLast = $global.___isLastFlush;\n  const didSerializeComponents = $global.___didSerializeComponents;\n  const prefix = $global.componentIdPrefix || $global.widgetIdPrefix;\n\n  if (len === 0) {\n    if (isLast && didSerializeComponents) {\n      return { p: prefix, l: 1 };\n    }\n\n    return;\n  }\n\n  const TYPE_INDEX = 1;\n  const typesLookup =\n    $global.___typesLookup || ($global.___typesLookup = new Map());\n  let newTypes;\n\n  for (let i = 0; i < len; i++) {\n    const componentDef = componentDefs[i];\n    const typeName = componentDef[TYPE_INDEX];\n    let typeIndex = typesLookup.get(typeName);\n\n    if (typeIndex === undefined) {\n      typeIndex = typesLookup.size;\n      typesLookup.set(typeName, typeIndex);\n\n      if (newTypes) {\n        newTypes.push(typeName);\n      } else {\n        newTypes = [typeName];\n      }\n    }\n\n    componentDef[TYPE_INDEX] = typeIndex;\n  }\n\n  let serializedGlobals;\n\n  if (!didSerializeComponents) {\n    $global.___didSerializeComponents = true;\n    serializedGlobals = getSerializedGlobals($global);\n  }\n\n  return {\n    p: prefix,\n    l: isLast && 1,\n    g: serializedGlobals,\n    w: componentDefs,\n    t: newTypes\n  };\n}\n\nfunction getInitComponentsDataFromOut(out) {\n  const componentsContext = out.___components;\n\n  if (componentsContext === null) {\n    return;\n  }\n\n  const $global = out.global;\n  const runtimeId = $global.runtimeId;\n  const componentsToHydrate = [];\n  addComponentsFromContext(componentsContext, componentsToHydrate);\n\n  $global.___isLastFlush = true;\n  const data = getInitComponentsData(out, componentsToHydrate);\n  $global.___isLastFlush = undefined;\n\n  if (runtimeId !== DEFAULT_RUNTIME_ID && data) {\n    data.r = runtimeId;\n  }\n\n  return data;\n}\n\nfunction writeInitComponentsCode(out) {\n  out.script(exports.___getInitComponentsCode(out));\n}\n\nexports.___getInitComponentsCode = function getInitComponentsCode(\n  out,\n  componentDefs\n) {\n  const initComponentsData =\n    arguments.length === 2\n      ? getInitComponentsData(out, componentDefs)\n      : getInitComponentsDataFromOut(out);\n\n  if (initComponentsData === undefined) {\n    return \"\";\n  }\n\n  const runtimeId = out.global.runtimeId;\n  const componentGlobalKey =\n    runtimeId === DEFAULT_RUNTIME_ID ? \"MC\" : runtimeId + \"_C\";\n\n  return `$${componentGlobalKey}=(window.$${componentGlobalKey}||[]).concat(${safeStringify(\n    initComponentsData\n  )})`;\n};\n\nexports.___addComponentsFromContext = addComponentsFromContext;\nexports.writeInitComponentsCode = writeInitComponentsCode;\n\n/**\n * Returns an object that can be sent to the browser using JSON.stringify. The parsed object should be\n * passed to require('marko-components').initComponents(...);\n *\n * @param  {ComponentsContext|AsyncWriter} componentsContext A ComponentsContext or an AsyncWriter\n * @return {Object} An object with information about the rendered components that can be serialized to JSON. The object should be treated as opaque\n */\nexports.getRenderedComponents = function (out) {\n  return warp10.stringifyPrepare(getInitComponentsDataFromOut(out));\n};\n"],"file":"index.js"}