{"version":3,"sources":["../../../src/runtime/html/StringWriter.js"],"names":["escapeDoubleQuotes","require","StringWriter","_content","_scripts","_data","prototype","write","str","script","get","key","extra","merge","otherWriter","push","apply","_writer","clear","toString","state","events","emit","outGlobal","root","global","cspNonce","nonceAttr","module","exports"],"mappings":"AAAA;;AAEA,IAAIA,kBAAkB;AACpBC,OAAO,CAAC,yBAAD,CAAP,IADF;;AAGA,SAASC,YAAT,GAAwB;AACtB,OAAKC,QAAL,GAAgB,EAAhB;AACA,OAAKC,QAAL,GAAgB,EAAhB;AACA,OAAKC,KAAL,GAAa,IAAb;AACD;;AAEDH,YAAY,CAACI,SAAb,GAAyB;AACvBC,EAAAA,KAAK,EAAE,UAAUC,GAAV,EAAe;AACpB,SAAKL,QAAL,IAAiBK,GAAjB;AACD,GAHsB;;AAKvBC,EAAAA,MAAM,EAAE,UAAUD,GAAV,EAAe;AACrB,QAAIA,GAAJ,EAAS;AACP,WAAKJ,QAAL,IAAiB,CAAC,KAAKA,QAAL,GAAgB,GAAhB,GAAsB,EAAvB,IAA6BI,GAA9C;AACD;AACF,GATsB;;AAWvBE,EAAAA,GAAG,EAAE,UAAUC,GAAV,EAAe;AAClB,UAAMC,KAAK,GAAI,KAAKP,KAAL,GAAa,KAAKA,KAAL,IAAc,EAA1C;AACA,WAAQO,KAAK,CAACD,GAAD,CAAL,GAAaC,KAAK,CAACD,GAAD,CAAL,IAAc,EAAnC;AACD,GAdsB;;AAgBvBE,EAAAA,KAAK,EAAE,UAAUC,WAAV,EAAuB;AAC5B,SAAKX,QAAL,IAAiBW,WAAW,CAACX,QAA7B;AACA,SAAKC,QAAL,IAAiBU,WAAW,CAACV,QAA7B;AACA,QAAIU,WAAW,CAACT,KAAhB,EAAuB;AACrB,UAAI,KAAKA,KAAT,EAAgB;AACd,aAAK,MAAMM,GAAX,IAAkBG,WAAW,CAACT,KAA9B,EAAqC;AACnC,cAAI,KAAKA,KAAL,CAAWM,GAAX,CAAJ,EAAqB;AACnB,iBAAKN,KAAL,CAAWM,GAAX,EAAgBI,IAAhB,CAAqBC,KAArB,CAA2B,KAAKX,KAAL,CAAWM,GAAX,CAA3B,EAA4CG,WAAW,CAACT,KAAZ,CAAkBM,GAAlB,CAA5C;AACD,WAFD,MAEO;AACL,iBAAKN,KAAL,CAAWM,GAAX,IAAkB,KAAKM,OAAL,CAAaN,GAAb,CAAlB;AACD;AACF;AACF,OARD,MAQO;AACL,aAAKN,KAAL,GAAaS,WAAW,CAACT,KAAzB;AACD;AACF;AACF,GAhCsB;;AAkCvBa,EAAAA,KAAK,EAAE,YAAY;AACjB,SAAKf,QAAL,GAAgB,EAAhB;AACA,SAAKC,QAAL,GAAgB,EAAhB;AACA,SAAKC,KAAL,GAAa,IAAb;AACD,GAtCsB;;AAwCvBc,EAAAA,QAAQ,EAAE,YAAY;AACpB,SAAKC,KAAL,CAAWC,MAAX,CAAkBC,IAAlB,OAAsC,IAAtC;AACA,QAAId,GAAG,GAAG,KAAKL,QAAf;AACA,QAAI,KAAKC,QAAT,EAAmB;AACjB,YAAMmB,SAAS,GAAG,KAAKH,KAAL,CAAWI,IAAX,CAAgBC,MAAlC;AACA,YAAMC,QAAQ,GAAGH,SAAS,CAACG,QAA3B;AACA,YAAMC,SAAS,GAAGD,QAAQ;AACtB,mBAAa1B,kBAAkB,CAAC0B,QAAD,CAA/B,GAA4C,GADtB;AAEtB,QAFJ;AAGAlB,MAAAA,GAAG,IAAK,UAASmB,SAAU,IAAG,KAAKvB,QAAS,WAA5C;AACD;AACD,WAAOI,GAAP;AACD,GApDsB,EAAzB;;;AAuDAoB,MAAM,CAACC,OAAP,GAAiB3B,YAAjB","sourcesContent":["\"use strict\";\n\nvar escapeDoubleQuotes =\n  require(\"./helpers/escape-quotes\").___escapeDoubleQuotes;\n\nfunction StringWriter() {\n  this._content = \"\";\n  this._scripts = \"\";\n  this._data = null;\n}\n\nStringWriter.prototype = {\n  write: function (str) {\n    this._content += str;\n  },\n\n  script: function (str) {\n    if (str) {\n      this._scripts += (this._scripts ? \";\" : \"\") + str;\n    }\n  },\n\n  get: function (key) {\n    const extra = (this._data = this._data || {});\n    return (extra[key] = extra[key] || []);\n  },\n\n  merge: function (otherWriter) {\n    this._content += otherWriter._content;\n    this._scripts += otherWriter._scripts;\n    if (otherWriter._data) {\n      if (this._data) {\n        for (const key in otherWriter._data) {\n          if (this._data[key]) {\n            this._data[key].push.apply(this._data[key], otherWriter._data[key]);\n          } else {\n            this._data[key] = this._writer[key];\n          }\n        }\n      } else {\n        this._data = otherWriter._data;\n      }\n    }\n  },\n\n  clear: function () {\n    this._content = \"\";\n    this._scripts = \"\";\n    this._data = null;\n  },\n\n  toString: function () {\n    this.state.events.emit(\"___toString\", this);\n    let str = this._content;\n    if (this._scripts) {\n      const outGlobal = this.state.root.global;\n      const cspNonce = outGlobal.cspNonce;\n      const nonceAttr = cspNonce\n        ? ' nonce=\"' + escapeDoubleQuotes(cspNonce) + '\"'\n        : \"\";\n      str += `<script${nonceAttr}>${this._scripts}</script>`;\n    }\n    return str;\n  }\n};\n\nmodule.exports = StringWriter;\n"],"file":"StringWriter.js"}